# API Mapping

This directory contains the phase of the PIG model responsible for mapping similar APIs, as described in step 2 (Extracting Plausible API Candidates) of the Overview. 


# Directory Structure 
### Results directory: `repos`
This directory contains the library implementations used in the experiments. Each library is stored in a subdirectory or a python file. These implementations are used to extract the APIs and their arguments, which are then used in the mapping process.

### API Mapping Answer: `answer.json`
To automate the verifying of the API mapping results, we provide `answer.json` file. This file contains the expected mapping results for each API based on the benchmark data. The structure of the file is as follows:

```json
{
  "FILENAME.json": {
    "APIName": {
      "apio": "oringinal API name",
      "answer": "expected API name",     
      "signo": "signature of the original API",
      "signn": "signature of the expected API",
    },
  },
}
```

Additionally, upper file is used to extract the API signatures when comparing the APIs.

### Extracting APIs: `api_lst.py`
This file contains the code to extract the APIs from the library implementations. It uses the `ast` module (`Cython` for cython files) to parse the Python files and extract the API names and their signatures. The extracted signatures of the APIs are used to compare the APIs and find similar ones. 

### Mapping: `compare_arg.py`
This file contains the main logic for mapping similar APIs. It reads the benchmark data from the `repos` directory, extracts the APIs using `api_lst.py`, and compares them with the expected results in `answer.json`. The results of the mapping are saved in a file named `MAPPING_RESULT.py` in the `mapping` directory. When running this script, it will automatically generate the mapping results based on the benchmark data and the expected results. 
`api_mapping()` function will be called to perform the mapping process.

### Result for API mapping: `MAPPING_RESULT.json` and `MAPPING_HISTORY.json`
This file contains the results of the API mapping process. It is generated by the `compare_arg` script and contains the mapping results for each API in the benchmark data. The structure of the file is as follows:

```python
{
  "FILENAME.json": {
    "APIName": {
      "apio": ["O | X", "Ranking"]
    },
  },
}
```

As extracting APIs is time-consuming, the `MAPPING_HISTORY.json` file contains the history of the mapping process, including the candidates for each API.

### Repo Paths: `gits.py`
This file contains the paths to the repositories of the libraries used in the experiments. `git_loc_old` and `git_loc` dictionaries map the library names to their respective paths in the `repos` directory for each original and target library, respectively.


# Adding new data
To add new data, you can follow these steps:
1. Clone the repository of the original and target library you want to add.
2. Copy the relevant files to the `repos` directory.
3. Update the `gits.py` file with the path to the libraries.
4. Update the `answer.json` file with the expected mapping results for the new APIs.
5. Run the `compare_arg.py` file to extract the APIs and compare them with the expected results. (It will automatically )