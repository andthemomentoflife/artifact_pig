# PIG Result

This repository contains the data and results of the "PIG: Leveraging Large Language Models for Python Library Migrations". 

# Directory Structure
### Benchmark directory: `benchmarks`
This directory contains the benchmark data used in the paper. It includes the following files:
- `<file_num>.json`: The json files containing the basic information about the benchmark, such as the source and target libraries, the client repository, commit hash, target apis to be changed and etc. 
- `<file_num>.py`: The python files containing the original and migrated code. The file containing the original code is named `<file_num>b.py`, and the file containing the migrated code is named `<file_num>a.py`.

### LLM source data directory: `llm_answer`
This directory contains the LLM generated code for the benchmark data, for each experiment run. Followings are the brief description of the files:
- `answer_baseline.xlsx`: The naive baseline of our experiments.
- `answer_slicing.xlsx`: The LLM generated code for the model where only slicing technique is used.
- `answer_pig.xlsx`: The LLM generated code for the model where slicing and API candidate provide techniques are used.
- `error.json`: The json file containing the error information of the LLM generated code in `answer_baseline.xlsx`. This file is used to generate the prompt for generatingi the LLM generated code in `answer_slicing.xlsx` and `answer_pig.xlsc`.

### Prompt directory: `prompt`
This directory contains the prompt templates we used in the experiments.
- `baseline.txt`: The prompt template for the naive baseline, which is generated by Claude's prompt generator.
- `slicing.txt`: The prompt template for the model where only slicing technique is used (Only the part where guiding API candidates are omitted from pig.txt).
- `pig.txt`: The prompt template for the model where slicing and API candidate provide techniques are used.

### Results directory: `results`
The results of the experiments are in this directory. For each research question, there are corresponding subdirectories.

#### RQ1 directory: `rq1`
This directory contains the results of RQ1, which is about the correctness of the naive baseline, slicing and PIG models. For each model, there is a subdirectory named `<model>`, which contains the following files:
- `LLM1json`: The migration resulsts of the navie baselie model per API.
- `LLM2json`: The migration results of the slicing model per API.
- `LLM4json`: The migration results of the PIG model per API.
  
Each top-level key represents a filename (e.g., `528.json`, `616.json`), and the corresponding value is a dictionary of test results for specific APIs.

#### Structure

```json
{
  "FILENAME.json": {
    "ObjectOrFunctionName": {
      "is_correct": "y" | "n",
      "reason": "short reason string"
    },
  },
}
```

#### RQ2 directory: `rq2`
This directory contains the results of RQ2, which is about the ablation study of the PIG model. Similar to `rq`, for each model, there is a subdirectory named `<model>`, which contains the following files:
- `default.json`: This file contains the results of the settings where only the default settings of gumtree is used. (settings *API* in paper)
- `nopost.json`: This file contains the results of the settings where the post-processing step is not used. (settings *MATCH* in paper*)
- `post.json`: This file contains the results of the settings where the post-processing step is used. (settings *PIG* in paper)

### RQ3 directory: `rq3`
This directory contains the results of RQ3, which is about the limitations.
`discussion.json` includes the discussion of the limitations of the PIG model, which is based on the results of the experiments.

#### Structure

```json
{
  "FILENAME.json": {
    "ObjectOrFunctionName": [
        "O" | "X",
        "ranking of the API candidates"
    ]
  },
}
```

### Src directory: `src`
This directory contains the source code of the work. 
You can execute the transplanting process by running the `src`/`synth`/`main.py`
Currently, it is not organized and not executable, but it will be updated continuously.
Followings are the brief description of each directory:
- `llm`: This directory contains the source code for querying the LLMs, including the code slicing. [**Finish**]
- `mapping`: This directory contains the source code for the mapping process, which is used to map the APIs in the source library to the APIs in the target library. [**Finish**]
- `synth`: This directory contains the source code for the transplanting process. [**In progress**]

Detailed information about the source code can be found in the `README.md` file in each directory.